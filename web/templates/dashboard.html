<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NginxÈò≤ÁÅ´Â¢ôÁÆ°ÁêÜÂêéÂè∞</title>
    
    <!-- ECharts -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary-color: #667eea;
            --danger-color: #f56565;
            --warning-color: #ed8936;
            --success-color: #48bb78;
            --bg-color: #f7fafc;
            --card-bg: #ffffff;
            --text-primary: #2d3748;
            --text-secondary: #718096;
            --border-color: #e2e8f0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-color);
            color: var(--text-primary);
            line-height: 1.6;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem 2rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header h1 {
            font-size: 1.5rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .health-status {
            display: flex;
            gap: 1rem;
            align-items: center;
        }
        
        .health-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #48bb78;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.12);
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary-color);
        }
        
        .stat-card.danger::before { background: var(--danger-color); }
        .stat-card.warning::before { background: var(--warning-color); }
        .stat-card.success::before { background: var(--success-color); }
        
        .stat-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        
        .stat-change {
            font-size: 0.75rem;
            color: var(--success-color);
        }
        
        .stat-change.negative {
            color: var(--danger-color);
        }
        
        .section {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border-color);
        }
        
        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .chart-container {
            height: 400px;
            width: 100%;
        }
        
        .tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid var(--border-color);
        }
        
        .tab {
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 1rem;
            color: var(--text-secondary);
            transition: all 0.3s;
            position: relative;
        }
        
        .tab.active {
            color: var(--primary-color);
        }
        
        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary-color);
        }
        
        .tab:hover {
            color: var(--primary-color);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        table th {
            background: var(--bg-color);
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 2px solid var(--border-color);
        }
        
        table td {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        table tr:hover {
            background: var(--bg-color);
        }
        
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .badge-critical { background: #fee; color: #c00; }
        .badge-high { background: #ffe; color: #f80; }
        .badge-medium { background: #ffc; color: #f80; }
        .badge-low { background: #efe; color: #080; }
        .badge-safe { background: #e0e7ff; color: #667eea; }
        
        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: #5568d3;
        }
        
        .btn-danger {
            background: var(--danger-color);
            color: white;
        }
        
        .btn-danger:hover {
            background: #e53e3e;
        }
        
        .btn-sm {
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
        }
        
        .loading {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }
        
        .loading-spinner {
            border: 3px solid var(--border-color);
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .search-box {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .search-box input {
            flex: 1;
            padding: 0.75rem;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .search-box input:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }
        
        @media (max-width: 768px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <h1>
                üõ°Ô∏è NginxÈò≤ÁÅ´Â¢ôÁÆ°ÁêÜÂêéÂè∞
            </h1>
            <div class="health-status">
                <a href="/firewall" class="btn btn-secondary" style="color:white;text-decoration:none;margin-right:0.5rem;">üî• Èò≤ÁÅ´Â¢ô</a>
                <a href="/rules" class="btn btn-secondary" style="color:white;text-decoration:none;margin-right:0.5rem;">üìã ËßÑÂàô</a>
                <a href="/ports" class="btn btn-secondary" style="color:white;text-decoration:none;margin-right:0.5rem;">üîå Á´ØÂè£</a>
                <a href="/settings" class="btn btn-secondary" style="color:white;text-decoration:none;margin-right:1rem;">‚öôÔ∏è ËÆæÁΩÆ</a>
                <div class="health-indicator">
                    <span class="status-dot"></span>
                    <span id="health-text">Á≥ªÁªüËøêË°å‰∏≠</span>
                </div>
                <span id="current-time" style="margin-right:1rem;"></span>
                <button class="btn btn-danger btn-sm" onclick="logout()">ÁôªÂá∫</button>
            </div>
        </div>
    </div>
    
    <div class="container">
        <!-- ÁªüËÆ°Âç°Áâá -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">üìä ÊÄªËØ∑Ê±ÇÊï∞ (24h)</div>
                <div class="stat-value" id="stat-requests">-</div>
                <div class="stat-change">ÂÆûÊó∂Êõ¥Êñ∞</div>
            </div>
            <div class="stat-card success">
                <div class="stat-label">üë• ÂîØ‰∏ÄIPÊï∞</div>
                <div class="stat-value" id="stat-ips">-</div>
                <div class="stat-change">Ê¥ªË∑ÉËÆøÈóÆËÄÖ</div>
            </div>
            <div class="stat-card danger">
                <div class="stat-label">üö´ Ê¥ªË∑ÉÂ∞ÅÁ¶Å</div>
                <div class="stat-value" id="stat-bans">-</div>
                <div class="stat-change">ÈúÄË¶ÅÂÖ≥Ê≥®</div>
            </div>
            <div class="stat-card warning">
                <div class="stat-label">‚ö†Ô∏è Â®ÅËÉÅÊ£ÄÊµã (24h)</div>
                <div class="stat-value" id="stat-threats">-</div>
                <div class="stat-change">ÂÆâÂÖ®Ë≠¶Êä•</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">üîç ÊåáÁ∫πÊï∞Èáè</div>
                <div class="stat-value" id="stat-fingerprints">-</div>
                <div class="stat-change">Ë°å‰∏∫ËøΩË∏™</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">üîó Ë∫´‰ªΩÈìæÊï∞Èáè</div>
                <div class="stat-value" id="stat-chains">-</div>
                <div class="stat-change">ÂÖ≥ËÅîÂàÜÊûê</div>
            </div>
        </div>
        
        <!-- ÂÆûÊó∂ÂõæË°® -->
        <div class="grid-2">
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">üìà Â®ÅËÉÅË∂ãÂäø</h2>
                </div>
                <div id="threat-trend-chart" class="chart-container"></div>
            </div>
            
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">üåç Âú∞ÁêÜ‰ΩçÁΩÆÂàÜÂ∏É</h2>
                </div>
                <div id="geo-chart" class="chart-container"></div>
            </div>
        </div>
        
        <div class="grid-2">
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">üéØ Â®ÅËÉÅËØÑÂàÜ Top 10</h2>
                </div>
                <div id="score-chart" class="chart-container"></div>
            </div>
            
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">üìä Â®ÅËÉÅÁ±ªÂûãÂàÜÂ∏É</h2>
                </div>
                <div id="threat-type-chart" class="chart-container"></div>
            </div>
        </div>
        
        <!-- Â®ÅËÉÅ‰∫ã‰ª∂ÂàóË°® -->
        <div class="section">
            <div class="section-header">
                <h2 class="section-title">üö® ÊúÄËøëÁöÑÂ®ÅËÉÅ‰∫ã‰ª∂</h2>
                <button class="btn btn-primary btn-sm" onclick="loadThreats()">üîÑ Âà∑Êñ∞</button>
            </div>
            <div id="threats-table">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <div>Âä†ËΩΩ‰∏≠...</div>
                </div>
            </div>
        </div>
        
        <!-- Â∞ÅÁ¶ÅÂàóË°® -->
        <div class="section">
            <div class="section-header">
                <h2 class="section-title">üö´ ÂΩìÂâçÂ∞ÅÁ¶ÅÂàóË°®</h2>
                <button class="btn btn-primary btn-sm" onclick="loadBans()">üîÑ Âà∑Êñ∞</button>
            </div>
            <div id="bans-table">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <div>Âä†ËΩΩ‰∏≠...</div>
                </div>
            </div>
        </div>
        
        <!-- IPÊêúÁ¥¢ -->
        <div class="section">
            <div class="section-header">
                <h2 class="section-title">üîç IP‰ø°ÊÅØÊü•ËØ¢</h2>
            </div>
            <div class="search-box">
                <input type="text" id="search-ip" placeholder="ËæìÂÖ•IPÂú∞ÂùÄ...">
                <button class="btn btn-primary" onclick="searchIP()">ÊêúÁ¥¢</button>
            </div>
            <div id="ip-info"></div>
        </div>
    </div>
    
    <script>
        // ÂàùÂßãÂåñÂõæË°®
        let threatTrendChart = echarts.init(document.getElementById('threat-trend-chart'));
        let geoChart = echarts.init(document.getElementById('geo-chart'));
        let scoreChart = echarts.init(document.getElementById('score-chart'));
        let threatTypeChart = echarts.init(document.getElementById('threat-type-chart'));
        
        // Êõ¥Êñ∞Êó∂Èó¥
        function updateTime() {
            document.getElementById('current-time').textContent = 
                new Date().toLocaleString('zh-CN');
        }
        setInterval(updateTime, 1000);
        updateTime();
        
        // Âä†ËΩΩÁªüËÆ°Êï∞ÊçÆ
        function loadStats() {
            fetch('/api/stats/overview')
                .then(r => r.json())
                .then(data => {
                    document.getElementById('stat-requests').textContent = data.total_requests.toLocaleString();
                    document.getElementById('stat-ips').textContent = data.unique_ips.toLocaleString();
                    document.getElementById('stat-bans').textContent = data.active_bans.toLocaleString();
                    document.getElementById('stat-threats').textContent = data.threats_detected.toLocaleString();
                    document.getElementById('stat-fingerprints').textContent = data.total_fingerprints.toLocaleString();
                    document.getElementById('stat-chains').textContent = data.total_chains.toLocaleString();
                });
        }
        
        // Âä†ËΩΩÂ®ÅËÉÅË∂ãÂäøÂõæ
        function loadThreatTrend() {
            fetch('/api/stats/threats')
                .then(r => r.json())
                .then(data => {
                    const option = {
                        title: { text: 'Â®ÅËÉÅÁªüËÆ°' },
                        tooltip: { trigger: 'item' },
                        grid: { left: '10%', right: '10%', bottom: '15%' },
                        xAxis: {
                            type: 'category',
                            data: Object.keys(data.by_type || {})
                        },
                        yAxis: { type: 'value' },
                        series: [{
                            data: Object.values(data.by_type || {}),
                            type: 'bar',
                            itemStyle: {
                                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                    {offset: 0, color: '#667eea'},
                                    {offset: 1, color: '#764ba2'}
                                ])
                            }
                        }]
                    };
                    threatTrendChart.setOption(option);
                });
        }
        
        // Âä†ËΩΩÂú∞ÁêÜ‰ΩçÁΩÆÂàÜÂ∏É
        function loadGeoDistribution() {
            fetch('/api/geo/countries')
                .then(r => r.json())
                .then(data => {
                    const chartData = Object.entries(data).map(([name, value]) => ({name, value}));
                    const option = {
                        title: { text: 'ËÆøÈóÆÊù•Ê∫êÂõΩÂÆ∂' },
                        tooltip: { trigger: 'item' },
                        series: [{
                            type: 'pie',
                            radius: ['40%', '70%'],
                            data: chartData,
                            emphasis: {
                                itemStyle: {
                                    shadowBlur: 10,
                                    shadowOffsetX: 0,
                                    shadowColor: 'rgba(0, 0, 0, 0.5)'
                                }
                            }
                        }]
                    };
                    geoChart.setOption(option);
                })
                .catch(e => console.log('Âú∞ÁêÜ‰ΩçÁΩÆÂäüËÉΩÊú™ÂêØÁî®'));
        }
        
        // Âä†ËΩΩËØÑÂàÜÊéíË°å
        function loadTopScores() {
            fetch('/api/scores/top?limit=10')
                .then(r => r.json())
                .then(data => {
                    const option = {
                        title: { text: 'Â®ÅËÉÅËØÑÂàÜÊéíË°å' },
                        tooltip: { trigger: 'axis' },
                        grid: { left: '15%', right: '10%', bottom: '15%' },
                        xAxis: { type: 'value' },
                        yAxis: {
                            type: 'category',
                            data: data.map(d => d.ip).reverse()
                        },
                        series: [{
                            data: data.map(d => d.score).reverse(),
                            type: 'bar',
                            itemStyle: {
                                color: function(params) {
                                    const colors = ['#48bb78', '#ed8936', '#f56565', '#c53030'];
                                    if (params.value < 60) return colors[0];
                                    if (params.value < 100) return colors[1];
                                    if (params.value < 150) return colors[2];
                                    return colors[3];
                                }
                            }
                        }]
                    };
                    scoreChart.setOption(option);
                })
                .catch(e => console.log('ËØÑÂàÜÁ≥ªÁªüÊú™ÂêØÁî®'));
        }
        
        // Âä†ËΩΩÂ®ÅËÉÅÁ±ªÂûãÂàÜÂ∏É
        function loadThreatTypes() {
            fetch('/api/stats/threats')
                .then(r => r.json())
                .then(data => {
                    const chartData = Object.entries(data.by_severity || {}).map(([name, value]) => ({name, value}));
                    const option = {
                        title: { text: 'Â®ÅËÉÅ‰∏•ÈáçÁ®ãÂ∫¶ÂàÜÂ∏É' },
                        tooltip: { trigger: 'item' },
                        series: [{
                            type: 'pie',
                            radius: '50%',
                            data: chartData,
                            itemStyle: {
                                borderRadius: 8,
                                borderColor: '#fff',
                                borderWidth: 2
                            },
                            label: {
                                formatter: '{b}: {c} ({d}%)'
                            }
                        }]
                    };
                    threatTypeChart.setOption(option);
                });
        }
        
        // Âä†ËΩΩÂ®ÅËÉÅÂàóË°®
        function loadThreats() {
            fetch('/api/threats/recent?limit=20')
                .then(r => r.json())
                .then(data => {
                    if (data.length === 0) {
                        document.getElementById('threats-table').innerHTML = 
                            '<p style="text-align:center;color:#888;padding:2rem;">ÊöÇÊó†Â®ÅËÉÅ‰∫ã‰ª∂</p>';
                        return;
                    }
                    
                    let html = '<table><thead><tr><th>Êó∂Èó¥</th><th>IP</th><th>Â®ÅËÉÅÁ±ªÂûã</th><th>‰∏•ÈáçÁ®ãÂ∫¶</th><th>ÊèèËø∞</th></tr></thead><tbody>';
                    
                    data.forEach(t => {
                        const time = new Date(t.timestamp).toLocaleString('zh-CN');
                        html += `<tr>
                            <td>${time}</td>
                            <td><code>${t.ip}</code></td>
                            <td>${t.threat_type}</td>
                            <td><span class="badge badge-${t.severity}">${t.severity}</span></td>
                            <td>${t.description}</td>
                        </tr>`;
                    });
                    
                    html += '</tbody></table>';
                    document.getElementById('threats-table').innerHTML = html;
                });
        }
        
        // Âä†ËΩΩÂ∞ÅÁ¶ÅÂàóË°®
        function loadBans() {
            fetch('/api/bans')
                .then(r => r.json())
                .then(data => {
                    if (data.length === 0) {
                        document.getElementById('bans-table').innerHTML = 
                            '<p style="text-align:center;color:#888;padding:2rem;">ÊöÇÊó†Â∞ÅÁ¶ÅËÆ∞ÂΩï</p>';
                        return;
                    }
                    
                    let html = '<table><thead><tr><th>IP</th><th>Â∞ÅÁ¶ÅÊó∂Èó¥</th><th>Ëß£Â∞ÅÊó∂Èó¥</th><th>ÂéüÂõ†</th><th>Ê¨°Êï∞</th><th>Êìç‰Ωú</th></tr></thead><tbody>';
                    
                    data.forEach(b => {
                        const bannedAt = new Date(b.banned_at).toLocaleString('zh-CN');
                        const banUntil = b.ban_until === 'Ê∞∏‰πÖ' ? 'Ê∞∏‰πÖ' : new Date(b.ban_until).toLocaleString('zh-CN');
                        
                        html += `<tr>
                            <td><code>${b.ip}</code></td>
                            <td>${bannedAt}</td>
                            <td>${banUntil}</td>
                            <td>${b.reason}</td>
                            <td>${b.ban_count}</td>
                            <td><button class="btn btn-danger btn-sm" onclick="unbanIP('${b.ip}')">Ëß£Â∞Å</button></td>
                        </tr>`;
                    });
                    
                    html += '</tbody></table>';
                    document.getElementById('bans-table').innerHTML = html;
                });
        }
        
        // Ëß£Â∞ÅIP
        function unbanIP(ip) {
            if (!confirm(`Á°ÆÂÆöË¶ÅËß£Â∞Å ${ip} ÂêóÔºü`)) return;
            
            fetch(`/api/bans/${ip}`, { method: 'DELETE' })
                .then(r => r.json())
                .then(data => {
                    if (data.success) {
                        alert('Ëß£Â∞ÅÊàêÂäü');
                        loadBans();
                        loadStats();
                    } else {
                        alert('Ëß£Â∞ÅÂ§±Ë¥•');
                    }
                });
        }
        
        // ÊêúÁ¥¢IP
        function searchIP() {
            const ip = document.getElementById('search-ip').value.trim();
            if (!ip) return;
            
            fetch(`/api/search/ip/${ip}`)
                .then(r => r.json())
                .then(data => {
                    let html = '<div style="margin-top:1rem;padding:1rem;background:#f7fafc;border-radius:8px;">';
                    html += `<h3>IP: ${data.ip}</h3>`;
                    html += `<p>ËÆøÈóÆÊ¨°Êï∞: ${data.log_count}</p>`;
                    
                    if (data.location) {
                        html += `<p>Âú∞ÁêÜ‰ΩçÁΩÆ: ${data.location.country} - ${data.location.city}</p>`;
                    }
                    
                    if (data.is_banned) {
                        html += `<p style="color:red;">Áä∂ÊÄÅ: Â∑≤Â∞ÅÁ¶Å</p>`;
                        html += `<p>Â∞ÅÁ¶ÅÂéüÂõ†: ${data.ban_info.reason}</p>`;
                    } else {
                        html += `<p style="color:green;">Áä∂ÊÄÅ: Ê≠£Â∏∏</p>`;
                    }
                    
                    html += '</div>';
                    document.getElementById('ip-info').innerHTML = html;
                });
        }
        
        // ÁõëÂê¨EnterÈîÆÊêúÁ¥¢
        document.getElementById('search-ip').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') searchIP();
        });
        
        // Á™óÂè£Â§ßÂ∞èÊîπÂèòÊó∂ÈáçÁªòÂõæË°®
        window.addEventListener('resize', function() {
            threatTrendChart.resize();
            geoChart.resize();
            scoreChart.resize();
            threatTypeChart.resize();
        });
        
        // ÂàùÂßãÂä†ËΩΩ
        loadStats();
        loadThreatTrend();
        loadGeoDistribution();
        loadTopScores();
        loadThreatTypes();
        loadThreats();
        loadBans();
        
        // ÁôªÂá∫ÂäüËÉΩ
        function logout() {
            if (!confirm('Á°ÆÂÆöË¶ÅÁôªÂá∫ÂêóÔºü')) return;
            
            fetch('/api/auth/logout', {method: 'POST'})
                .then(r => r.json())
                .then(data => {
                    if (data.success) {
                        window.location.href = '/login';
                    }
                });
        }
        
        // ÂÆöÊó∂Âà∑Êñ∞
        setInterval(loadStats, 10000);  // 10Áßí
        setInterval(loadThreatTrend, 30000);  // 30Áßí
        setInterval(loadThreats, 30000);
        setInterval(loadBans, 30000);
    </script>
</body>
</html>
