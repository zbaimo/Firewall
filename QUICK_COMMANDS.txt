====================================================
  å¸¸ç”¨ç®¡ç†å‘½ä»¤
====================================================

ç³»ç»Ÿå·²æˆåŠŸå¯åŠ¨ï¼è®¿é—®: http://æ‚¨çš„æœåŠ¡å™¨IP:8800

====================================================
  Docker Compose å‘½ä»¤
====================================================

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose -f docker-compose.deploy.yml ps

# æŸ¥çœ‹æ—¥å¿—ï¼ˆå®æ—¶ï¼‰
docker-compose -f docker-compose.deploy.yml logs -f

# åªçœ‹é˜²ç«å¢™æ—¥å¿—
docker-compose -f docker-compose.deploy.yml logs -f firewall

# åªçœ‹Redisæ—¥å¿—
docker-compose -f docker-compose.deploy.yml logs -f redis

# é‡å¯æœåŠ¡
docker-compose -f docker-compose.deploy.yml restart

# åœæ­¢æœåŠ¡
docker-compose -f docker-compose.deploy.yml down

# å¯åŠ¨æœåŠ¡
docker-compose -f docker-compose.deploy.yml up -d

# æ›´æ–°é•œåƒ
docker-compose -f docker-compose.deploy.yml pull
docker-compose -f docker-compose.deploy.yml up -d

====================================================
  æ—¥å¿—æŸ¥çœ‹
====================================================

# å®¡è®¡æ—¥å¿—
tail -f logs/audit.log

# ç³»ç»Ÿæ—¥å¿—
tail -f logs/firewall.log

# å¯¼å‡ºè®°å½•
ls -la exports/

# å®¹å™¨æ—¥å¿—ï¼ˆæœ€è¿‘100è¡Œï¼‰
docker logs nginx-firewall --tail 100

# å®¹å™¨æ—¥å¿—ï¼ˆå®æ—¶ï¼‰
docker logs -f nginx-firewall

====================================================
  ç³»ç»Ÿç›‘æ§
====================================================

# èµ„æºä½¿ç”¨
docker stats nginx-firewall firewall-redis

# è¿›ç¨‹çŠ¶æ€
docker top nginx-firewall

# ç£ç›˜ä½¿ç”¨
du -sh logs/ exports/ data/

# ç«¯å£ç›‘å¬
netstat -tunlp | grep 8800

# Redisè¿æ¥
docker exec -it firewall-redis redis-cli ping

====================================================
  é˜²ç«å¢™è§„åˆ™
====================================================

# æŸ¥çœ‹iptablesè§„åˆ™
iptables -L -n | grep FIREWALL

# æŸ¥çœ‹å°ç¦çš„IP
iptables -L -n | grep DROP

# æ¸…ç©ºé˜²ç«å¢™è§„åˆ™ï¼ˆå±é™©ï¼ï¼‰
# iptables -F

# å…è®¸ç‰¹å®šIPè®¿é—®8800ç«¯å£
iptables -A INPUT -s YOUR_IP -p tcp --dport 8800 -j ACCEPT

====================================================
  å¤‡ä»½å’Œæ¢å¤
====================================================

# å¤‡ä»½æ•°æ®åº“
docker exec nginx-firewall sqlite3 /data/firewall.db .dump > backup.sql

# å¤‡ä»½é…ç½®
tar czf backup_$(date +%Y%m%d).tar.gz config.yaml logs/ exports/

# æ¢å¤æ•°æ®åº“
docker exec -i nginx-firewall sqlite3 /data/firewall.db < backup.sql

====================================================
  Webç®¡ç†ç•Œé¢
====================================================

è®¿é—®åœ°å€: http://YOUR_SERVER_IP:8800

é»˜è®¤ç™»å½•:
  ç”¨æˆ·å: admin
  å¯†ç : admin

é¦–æ¬¡ç™»å½•åä¼šå¼ºåˆ¶ä¿®æ”¹å¯†ç ï¼

ä¸»è¦åŠŸèƒ½:
  - å®æ—¶ç›‘æ§ä»ªè¡¨æ¿
  - IPé»‘åå•ç®¡ç†
  - å¨èƒè®°å½•æŸ¥çœ‹
  - ç«¯å£ç®¡ç†
  - ç³»ç»Ÿè®¾ç½®
  - 2FAè®¾ç½®

====================================================
  æ•…éšœæ’æŸ¥
====================================================

# æ£€æŸ¥å®¹å™¨æ˜¯å¦è¿è¡Œ
docker ps | grep firewall

# æŸ¥çœ‹å®¹å™¨è¯¦æƒ…
docker inspect nginx-firewall

# è¿›å…¥å®¹å™¨è°ƒè¯•
docker exec -it nginx-firewall bash

# æµ‹è¯•Redisè¿æ¥
docker exec -it nginx-firewall redis-cli -h localhost ping

# æ£€æŸ¥é…ç½®æ–‡ä»¶
docker exec nginx-firewall cat /app/config.yaml

# æ£€æŸ¥Nginxæ—¥å¿—æ˜¯å¦å¯è¯»
docker exec nginx-firewall ls -la /var/log/nginx/logs/

# æµ‹è¯•APIç«¯ç‚¹
curl http://localhost:8800/api/system/health

====================================================
  æ€§èƒ½ä¼˜åŒ–
====================================================

# æŸ¥çœ‹Redisä¿¡æ¯
docker exec firewall-redis redis-cli info

# æ¸…ç†Redisç¼“å­˜
docker exec firewall-redis redis-cli FLUSHALL

# æ¸…ç†æ—§æ—¥å¿—
find logs/ -name "*.log" -mtime +7 -delete

# æ¸…ç†æ—§å¯¼å‡ºæ–‡ä»¶
find exports/ -mtime +30 -delete

# ä¼˜åŒ–æ•°æ®åº“
docker exec nginx-firewall sqlite3 /data/firewall.db "VACUUM;"

====================================================
  æ›´æ–°ç³»ç»Ÿ
====================================================

# æ‹‰å–æœ€æ–°é•œåƒ
docker pull zbaimo/nginx-firewall:latest

# å¤‡ä»½æ•°æ®
tar czf backup_$(date +%Y%m%d).tar.gz logs/ exports/ config.yaml

# åœæ­¢å¹¶åˆ é™¤æ—§å®¹å™¨
docker-compose -f docker-compose.deploy.yml down

# å¯åŠ¨æ–°å®¹å™¨
docker-compose -f docker-compose.deploy.yml up -d

# éªŒè¯
docker-compose -f docker-compose.deploy.yml logs -f

====================================================
  å®‰å…¨å»ºè®®
====================================================

1. ç«‹å³ä¿®æ”¹é»˜è®¤å¯†ç 
   - ç™»å½•åå° â†’ è®¾ç½® â†’ ä¿®æ”¹å¯†ç 

2. å¯ç”¨2FA
   - è®¾ç½® â†’ ä¸¤æ­¥éªŒè¯

3. é…ç½®é˜²ç«å¢™
   ufw allow 22/tcp
   ufw allow 8800/tcp
   ufw enable

4. å®šæœŸå¤‡ä»½
   - è®¾ç½®å®šæ—¶ä»»åŠ¡å¤‡ä»½æ•°æ®

5. ç›‘æ§æ—¥å¿—
   - å®šæœŸæ£€æŸ¥ logs/audit.log
   - æŸ¥çœ‹å¨èƒè®°å½•

====================================================

ç³»ç»Ÿè¿è¡Œæ­£å¸¸ï¼å¼€å§‹ä½¿ç”¨å§ï¼ ğŸš€

è®¿é—®: http://YOUR_SERVER_IP:8800

====================================================


